---
title: "Colles 4"
output: html_document
date: "2023-03-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Sujet 1 :

```{r}
# Définir les paramètres de la loi normale
mu <- 1
sigma <- 1
```

```{r}
# Calculer l'intervalle centré en µ pour une probabilité de 0.99
intervalle <- qnorm(c(0.005, 0.995), mean = mu, sd = sigma)
intervalle

# Représenter la densité et la fonction de répartition de la loi normale
x <- seq(mu - 4*sigma, mu + 4*sigma, length = 100)
plot(x, dnorm(x, mean = mu, sd = sigma), type = "l", 
     xlab = "X", ylab = "Densité", main = "Densité et fonction de répartition")
lines(x, pnorm(x, mean = mu, sd = sigma), col = "red")

# Calcul des quartiles
q1 <- qnorm(0.25, mean = 1, sd = 1)
q2 <- qnorm(0.5, mean = 1, sd = 1)
q3 <- qnorm(0.75, mean = 1, sd = 1)

# Ajout des éléments de lecture graphique des quartiles
abline(h = q1, lty = 3, col = "green")
text(x = c[2], y = q1, labels = expression(paste("Q",c[1], " = ", q1)), pos = 4, col = "green")
abline(h = q2, lty = 3, col = "green")
text(x = c[2], y = q2, labels = expression(paste("Q",c[2], " = ", q2)), pos = 4, col = "green")
abline(h = q3, lty = 3, col = "green")
text(x = c[2], y = q3, labels = expression(paste("Q",c[3], " = ", q3)), pos = 4, col = "green")
```
# Sujet 2 :

## Question 1 :

```{r}
# Quantiles d'ordre p de U
qu <- qnorm(seq(0.1, 0.9, by = 0.1))

# Quantiles d'ordre correspondants de X
qx <- qnorm(seq(0.1, 0.9, by = 0.1), mean = 2, sd = sqrt(3))

# Nuage de points
plot(qu, qx, xlab = "Quantiles de U", ylab = "Quantiles de X")
```

## Question 2 :

```{r}
# Régression linéaire
reg <- lm(qx ~ qu)

# Affichage de la droite
plot(qu, qx, xlab = "Quantiles de U", ylab = "Quantiles de X")
abline(reg, col = "red")

# Expression du quantile d'ordre alpha de X en fonction de U
quantile_X <- function(alpha) {
  beta <- reg$coefficients[1]
  gamma <- reg$coefficients[2]
  gamma * qnorm(alpha) + beta}
```

# Sujet 3 : 

```{r}
read.table("donneesSerie4.csv",sep=" ",dec=".")->dat
```

## Question 1 :

```{r}
e1=dat$V1
e2=dat$V2
```

```{r}
#Résumé numérique et comparaison des échantillons
summary(e1)
summary(e2)
var(e1)
var(e2)
sd(e1)
sd(e2)
sd(e1) / sqrt(length(e1)-1)
sd(e2) / sqrt(length(e2)-1)
```

On constate que les deux échantillons ont des moyennes et variances différentes,mais que leurs écarts-types empiriques corrigés sont proches.

## Question 2 :

```{r}
#QQ-plot et comparaison des échantillons
par(mfrow=c(1,2)) # pour avoir 2 graphiques côte à côte
qqnorm(e1)
abline(mean(e1), sd(e1) / sqrt(length(e1)-1), col="red")
qqnorm(e2, ylim=c(-3,3)) # pour avoir les mêmes limites en ordonnées
abline(mean(e2), sd(e2) / sqrt(length(e2)-1), col="red")
```

# Sujet 4 :

```{r}
read.table("donneesSerie4.csv",sep=" ",dec=".")->dat
```

## Question 1 :

```{r}
e3=dat$V3
e4=dat$V4
```

```{r}
#Résumé numérique et comparaison des échantillons
summary(e3)
summary(e4)
var(e3)
var(e4)
sd(e3)
sd(e4)
sd(e3) / sqrt(length(e3)-1)
sd(e4) / sqrt(length(e4)-1)
```

On constate que les deux échantillons ont des moyennes et variances différentes,mais que leurs écarts-types empiriques corrigés sont proches.

## Question 2 :

```{r}
#QQ-plot et comparaison des échantillons
par(mfrow=c(1,2)) # pour avoir 2 graphiques côte à côte
qqnorm(e3)
abline(mean(e3), sd(e3) / sqrt(length(e3)-1), col="red")
qqnorm(e4, ylim=c(-3,3)) # pour avoir les mêmes limites en ordonnées
abline(mean(e4), sd(e4) / sqrt(length(e4)-1), col="red")
```

# Sujet 5 :

```{r}
read.table("donneesSerie4.csv",sep=" ",dec=".")->dat
```

## Question 1 :

```{r}
e5=dat$V5
e6=dat$V6
```

```{r}
#Résumé numérique et comparaison des échantillons
summary(e5)
summary(e6)
var(e5)
var(e6)
sd(e5)
sd(e6)
sd(e5) / sqrt(length(e5)-1)
sd(e6) / sqrt(length(e6)-1)
```

On constate que les deux échantillons ont des moyennes et variances différentes,mais que leurs écarts-types empiriques corrigés sont proches.

## Question 2 :

```{r}
#QQ-plot et comparaison des échantillons
par(mfrow=c(1,2)) # pour avoir 2 graphiques côte à côte
qqnorm(e5)
abline(mean(e5), sd(e5) / sqrt(length(e5)-1), col="red")
qqnorm(e6, ylim=c(-3,3)) # pour avoir les mêmes limites en ordonnées
abline(mean(e6), sd(e6) / sqrt(length(e6)-1), col="red")
```

# Sujet 6 :

```{r}
read.table("donneesSerie4.csv",sep=" ",dec=".")->dat
```


## Question 1 :

```{r}
# Histogrammes et QQ-plots
par(mfrow = c(2, 6))

for (i in 1:6) {
  # Histogramme avec verticale rouge pour la moyenne
  hist(dat[, i], freq = FALSE, main = paste("Histogramme", i))
  abline(v = mean(dat[, i]), col = "red")
  
  # QQ-plot avec droite de Henry
  qqnorm(dat[, i], main = paste("QQ-plot", i))
  abline(a = mean(dat[, i]), b = sd(dat[, i], na.rm = TRUE), col = "red")
}
```

